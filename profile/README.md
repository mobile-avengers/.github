# SRS документация.

## 1. Введение

### 1.1 Приложение

+ Приложение должно поддерживать работу на Android.

+ Приложение должно иметь простой и понятный интерфейс.

+ Приложение должно иметь возможность авторизации и регистрации пользователей.

+ Приложение должно иметь возможность создания лотов на покупку товара.

+ Приложение реализует возможность заказа различных товаров с доставкой с Dewu,
так как напрямую заказать товары с данной площадки на территорию РФ нет возможности.
Приложение осуществляет роль посредника между Dewu и пользователем.

### 1.2 Определения

- **Лот** -- товар, который попал в корзину, но ещё не оплачен.

- **Корзина** -- список всех лотов клиента. Товары из корзины можно оплатить.

- **Заказ** -- оплаченный товар.




## 2. Требования

### 2.1 Функциональные требования

#### 2.1.1 Требования к системе регистрации/авторизации

1) Система предоставляет возможность создать аккаунт всем незарегистрированным/не аутентифицированным пользователям.

2) Аутентификация доступна только зарегистрированным пользователям.

#### 2.1.2 Требования к системе заказов

1) Система должна предоставлять возможность создать лоты товара(клиент прикрепляет ссылку на товар с Dewu).

2) Система должна предоставлять возможность просмотра созданных ранее лотов(в корзине клиента).

3) Система должна предоставлять возможность выкупа/оплаты лота(товара). После этого администратор может подтвердить
выкуп товара или отменить платёж(например, если товара нет в наличии). Статус лота/товара при этом изменится
на клиентской стороне.

4) Система должна предоставлять возможность просмотра все заказов(оплаченных) пользователя.

5) Система должна предоставлять возможность удаления лотов до их оплаты из корзины.


### 2.2 Нефункциональные требования

#### 2.2.1 Поддерживаемость

1) Регистрация пользователя возможна по почте.

2) Интерфейс приложения -- русский.

#### 2.2.2 Надёжность

1) Приложение должно логгировать действия клиентов/сервера, для удобного поиска ошибок в случае их появления.

2) Приложение должно гарантировать безопасность оплаты каждым из доступных способов(по карте, СБП). Приложение
должно поддерживать оплату в рублях. Приложение должно гарантировать безопасную передачу ключей доступа и почт клиентов

#### 2.2.3 Производительность

1) Время отклика < 1 секунд при одновременной обработке 50 запросов в секунду.

#### 2.2.4 Безопасность

1) Пользователь не может посмотреть корзину другого пользователя.

2) Данные о пользователе должны быть защищены (как минимум: хэширование пароля)



## 3. Роли, модель.

| Роль                               | Полномочия                                                                                                                                          |
|:-----------------------------------|:----------------------------------------------------------------------------------------------------------------------------------------------------|
| Неавторизованный <br/>пользователь | Регистрация<br/>Вход                                                                                                                                |
| Авторизованный <br/>пользователь   | Создание лота<br/>Просмотр коризны<br/>Оплата товара<br/>Просмотр заказов                                                                           |
| Администратор                      | Наследует все полномочия авторизованного пользователя<br/>Просмотр заказов от пользователей<br/>Перевод заказа в состояние отмены или подтверждения |


## Архитектура

Будет реализована микросервисная архитиектура на основе подхода "api-gateway". Будет всего два сервиса: сервис авторизации и сервис заказов. Каждый микросервис имеет отдельную бд.

![architecture](img/architecture.svg)

Метрики с инстансов сервисов собирает prometheus. Логи собирает promtail и отправляет в grafana loki. Grafana предоставляет интерфейс для доступа к логам и метрикам.

- `mobile app` - мобильное приложение
- `api gateway` - прокси-сервервер, который фильтрует траффик, если для маршрута запрошена авторизация
- `oauth` - сервис авторизации, автуризует пользователя и занимается вадачей и подтвержднием токенов
- `orders service` - сервис, который выполняет бизнес-логику
- `tsbd` - time series database
- `loki` - grafana loki
